<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>


<div class="popup_container">

    <button class="popup_close">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 48 48" fill="none"> <path fill-rule="evenodd" clip-rule="evenodd" d="M1.31802 1.31802C3.07538 -0.43934 5.92462 -0.43934 7.68198 1.31802L23.75 17.386L39.818 1.31802C41.5754 -0.43934 44.4246 -0.43934 46.182 1.31802C47.9393 3.07538 47.9393 5.92462 46.182 7.68198L30.114 23.75L46.182 39.818C47.9393 41.5754 47.9393 44.4246 46.182 46.182C44.4246 47.9393 41.5754 47.9393 39.818 46.182L23.75 30.114L7.68198 46.182C5.92462 47.9393 3.07538 47.9393 1.31802 46.182C-0.43934 44.4246 -0.43934 41.5754 1.31802 39.818L17.386 23.75L1.31802 7.68198C-0.43934 5.92462 -0.43934 3.07538 1.31802 1.31802Z" fill="#F60EA6"></path> </svg>
    </button>

    <img src="{{ 'popup_img.jpg' | asset_url }}" loading="lazy" id="w-node-_5bf9ab54-2d3f-1f84-bf3c-4a30a2e82eeb-07f8c27d" sizes="100vw" alt="" srcset="{{ 'popup_img-p-500.jpg' | asset_url }} 500w, {{ 'popup_img.jpg' | asset_url }} 800w" class="popup_img">
    
   {% comment %}
  Assume this is within a Shopify Liquid template file, like 'customer.liquid'
{% endcomment %}

{% form 'customer' %}
    <div class="email">
      <label for="email">Email</label>
      <input type="email" name="contact[email]" id="email-input" required />
    </div>
  
    <a href="#" class="sudosubmit-btn">sign up</a>
    
    <div class="success-banner" style="display: none;">
      <p>Use promo code welcome10 at checkout</p>
    </div>
    
    <div class="submit">
      <input type="submit" value="Sign up"/>
    </div>
  {% endform %}
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      var fakeButton = document.querySelector('.sudosubmit-btn');
      var successBanner = document.querySelector('.success-banner');
      var submitButton = document.querySelector('input[type="submit"]');
      
      // Function to show success banner and automatically submit form after delay
      function showSuccessAndSubmit(event) {
        event.preventDefault(); // Prevent the default link behavior
        
        successBanner.style.display = 'block'; // Show success banner
        
        setTimeout(function() {
          submitButton.click(); // Simulate click on submit button after 10 seconds
        }, 10000); // 10000 milliseconds = 10 seconds
      }
      
      // Attach click event listener to the fake button
      fakeButton.addEventListener('click', showSuccessAndSubmit);
    });
  </script>
  

</div>
{% comment %} 
<script>

    const showPopupKey = "showPromoPopup";
    const closeButton = document.querySelector(".popup_close");
    const sudoPromoButton = document.getElementById("sudo-promo-btn");
    const copyCodeButton = document.getElementById("copy-code");
    const promoCodeSpan = document.getElementById("promo-code");
    const popupContainer = document.querySelector(".popup_container");
    const offerPopupWrapper = document.querySelector(".offer-popup_wrapper");
    const successContent = document.querySelector(".popup_content.is-success");
    const promoFormBtn = document.getElementById("promo-form-btn");

    // Helper function to show the popup
    function showPopup() {
        const tl = gsap.timeline();
        tl.set(offerPopupWrapper, { display: "flex" })
          .to(offerPopupWrapper, { opacity: 1, duration: 1 })
          .to(popupContainer, { y: "0vh", duration: 1 }, "-=1");
    }

    // Helper function to close the popup
    function closePopup() {
        const tl = gsap.timeline();
        tl.to(popupContainer, { y: "100vh", duration: 1 })
          .to(offerPopupWrapper, { opacity: 0, duration: 1 }, "-=1")
          .set(offerPopupWrapper, { display: "none" });
    }

    // Check local storage to decide whether to show the popup
    if (!localStorage.getItem(showPopupKey)) {
        showPopup();
        localStorage.setItem(showPopupKey, Date.now());
    } else {
        const lastShown = parseInt(localStorage.getItem(showPopupKey), 10);
        const now = Date.now();
        const oneDay = 24 * 60 * 60 * 1000;
        if (now - lastShown > oneDay) {
            showPopup();
            localStorage.setItem(showPopupKey, Date.now());
        }
    }

    // Close popup on close button click
    closeButton.addEventListener("click", closePopup);

    // Handle sudo promo button click
    sudoPromoButton.addEventListener("click", function (event) {
        event.preventDefault();
        const tl = gsap.timeline();
        tl.to(successContent, { y: "0%", duration: 1 });
        setTimeout(() => {
            promoFormBtn.click();
        }, 1000);
    });

    // Handle copy code button click
    copyCodeButton.addEventListener("click", function (event) {
        event.preventDefault();
        navigator.clipboard.writeText(promoCodeSpan.innerText).then(() => {
            alert("Promo code copied to clipboard!");
        });
    });

    // Handle form submission to prevent popup for 30 days
    const form = document.querySelector('form');
    form.addEventListener('submit', function () {
        const thirtyDays = 30 * 24 * 60 * 60 * 1000;
        localStorage.setItem(showPopupKey, Date.now() + thirtyDays);
    });



</script> {% endcomment %}

{% schema %}
{
  "name": "Promo Popup",
  "class": "offer-popup_wrapper",
  "settings": [
    {
      "type": "text",
      "id": "promo_heading",
      "label": "Promo Heading",
      "default": "10% off your first order"
    },
    {
      "type": "textarea",
      "id": "promo_paragraph",
      "label": "Promo Paragraph",
      "default": "Subscribe to receive 10% off your first order, along with product updates and exclusive offers!"
    },
    {
      "type": "text",
      "id": "submit_button_text",
      "label": "Submit Button Text",
      "default": "submit"
    },
    {
      "type": "textarea",
      "id": "promo_disclaimer",
      "label": "Promo Disclaimer",
      "default": "By subscribing, you agree to receive marketing emails from us. You may unsubscribe at any time"
    },
    {
      "type": "text",
      "id": "success_heading",
      "label": "Success Heading",
      "default": "You're in!"
    },
    {
      "type": "textarea",
      "id": "success_code_part1",
      "label": "Success Code Part 1",
      "default": "Use the code"
    },
    {
      "type": "text",
      "id": "success_code",
      "label": "Success Code",
      "default": "WELCOME10"
    },
    {
      "type": "textarea",
      "id": "success_code_part2",
      "label": "Success Code Part 2",
      "default": "at checkout for a discount on your first order!"
    },
    {
      "type": "text",
      "id": "copy_code_button_text",
      "label": "Copy Code Button Text",
      "default": "Copy code"
    }
  ]
}
{% endschema %}
